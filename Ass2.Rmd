---
title: "Assiment 2 - group 16"
author: "Bjark Dahl Mogensen, Mikkel Mertz og Benjamin Wedel Mathiasen"
date: "9. nov. 2015"
output: pdf_document
---



```{r}
library ("plyr")
library ("dplyr")
library ("rvest")
library ("readr")
library ("knitr")
library ("stringr")
library ("xml2")
```


```{r}
link_ipaidabribe = paste("http://www.ipaidabribe.com/reports/paid?page=", 0:99, 0, sep = "")

scrape_ipaidabribe = function (link_ipaidabribe) {
  my.link = read_html(link_ipaidabribe, encoding= "UTF-8")
  my.location = my.link %>%
    html_nodes(".location " ) %>%
    html_text()
  my.date = my.link %>%
    html_nodes(".date " ) %>%
    html_text()
  my.transactiondetail = my.link %>%
    html_nodes(".transaction a" ) %>%
    html_text()
  my.depname = my.link %>%
    html_nodes(".name a" ) %>%
    html_text()
  my.title = my.link %>%
    html_nodes(".heading-3 a" ) %>%
    html_text()
  my.views = my.link %>%
    html_nodes(".overview .views" ) %>%
    html_text()
  my.payment = my.link %>%
    html_nodes(".paid-amount span" ) %>%
    html_text()
  my.refnumber = my.link %>%
    html_nodes(".unique-reference" ) %>%
    html_text()
  return (cbind(my.title, my.payment, my.depname, my.transactiondetail, my.views, my.location, my.date, my.refnumber))  
}

my.ipaidabribe.data = list() 
for (i in link_ipaidabribe){
  print(paste("processing", i, sep = " "))
  my.ipaidabribe.data[[i]] = scrape_ipaidabribe(i)
    Sys.sleep(0.25)
  cat(" done!\n")
}

df=ldply(my.ipaidabribe.data, data.frame)
```


```{r}
df.backup = df

```